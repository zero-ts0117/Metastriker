{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/zero-ts0117/metastriker/blob/main/Metastriker_automeeting\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "n58KHbAsmVGB",
        "outputId": "5f68761a-da9d-43a0-b6dd-8545d5f55d4d"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "(Reading database ... 122541 files and directories currently installed.)\n",
            "Preparing to unpack .../libudev1_245.4-4ubuntu3.21_amd64.deb ...\n",
            "Unpacking libudev1:amd64 (245.4-4ubuntu3.21) over (245.4-4ubuntu3.19) ...\n",
            "Setting up libudev1:amd64 (245.4-4ubuntu3.21) ...\n",
            "Selecting previously unselected package udev.\n",
            "(Reading database ... 122541 files and directories currently installed.)\n",
            "Preparing to unpack .../00-udev_245.4-4ubuntu3.21_amd64.deb ...\n",
            "Unpacking udev (245.4-4ubuntu3.21) ...\n",
            "Selecting previously unselected package libevent-2.1-6:amd64.\n",
            "Preparing to unpack .../01-libevent-2.1-6_2.1.8-stable-4_amd64.deb ...\n",
            "Unpacking libevent-2.1-6:amd64 (2.1.8-stable-4) ...\n",
            "Selecting previously unselected package libicu63:amd64.\n",
            "Preparing to unpack .../02-libicu63_63.1-6+deb10u3_amd64.deb ...\n",
            "Unpacking libicu63:amd64 (63.1-6+deb10u3) ...\n",
            "Selecting previously unselected package libjpeg62-turbo:amd64.\n",
            "Preparing to unpack .../03-libjpeg62-turbo_1%3a1.5.2-2+deb10u1_amd64.deb ...\n",
            "Unpacking libjpeg62-turbo:amd64 (1:1.5.2-2+deb10u1) ...\n",
            "Selecting previously unselected package libre2-5:amd64.\n",
            "Preparing to unpack .../04-libre2-5_20200101+dfsg-1build1_amd64.deb ...\n",
            "Unpacking libre2-5:amd64 (20200101+dfsg-1build1) ...\n",
            "Selecting previously unselected package libvpx5:amd64.\n",
            "Preparing to unpack .../05-libvpx5_1.7.0-3+deb10u1_amd64.deb ...\n",
            "Unpacking libvpx5:amd64 (1.7.0-3+deb10u1) ...\n",
            "Selecting previously unselected package libfontenc1:amd64.\n",
            "Preparing to unpack .../06-libfontenc1_1%3a1.1.4-0ubuntu1_amd64.deb ...\n",
            "Unpacking libfontenc1:amd64 (1:1.1.4-0ubuntu1) ...\n",
            "Selecting previously unselected package libxkbfile1:amd64.\n",
            "Preparing to unpack .../07-libxkbfile1_1%3a1.1.0-1_amd64.deb ...\n",
            "Unpacking libxkbfile1:amd64 (1:1.1.0-1) ...\n",
            "Selecting previously unselected package libxtst6:amd64.\n",
            "Preparing to unpack .../08-libxtst6_2%3a1.2.3-1_amd64.deb ...\n",
            "Unpacking libxtst6:amd64 (2:1.2.3-1) ...\n",
            "Selecting previously unselected package libxxf86dga1:amd64.\n",
            "Preparing to unpack .../09-libxxf86dga1_2%3a1.1.5-0ubuntu1_amd64.deb ...\n",
            "Unpacking libxxf86dga1:amd64 (2:1.1.5-0ubuntu1) ...\n",
            "Selecting previously unselected package x11-utils.\n",
            "Preparing to unpack .../10-x11-utils_7.7+5_amd64.deb ...\n",
            "Unpacking x11-utils (7.7+5) ...\n",
            "Selecting previously unselected package chromium-common.\n",
            "Preparing to unpack .../11-chromium-common_90.0.4430.212-1~deb10u1_amd64.deb ...\n",
            "Unpacking chromium-common (90.0.4430.212-1~deb10u1) ...\n",
            "Selecting previously unselected package chromium.\n",
            "Preparing to unpack .../12-chromium_90.0.4430.212-1~deb10u1_amd64.deb ...\n",
            "Unpacking chromium (90.0.4430.212-1~deb10u1) ...\n",
            "Selecting previously unselected package chromium-driver.\n",
            "Preparing to unpack .../13-chromium-driver_90.0.4430.212-1~deb10u1_amd64.deb ...\n",
            "Unpacking chromium-driver (90.0.4430.212-1~deb10u1) ...\n",
            "Selecting previously unselected package chromium-sandbox.\n",
            "Preparing to unpack .../14-chromium-sandbox_90.0.4430.212-1~deb10u1_amd64.deb ...\n",
            "Unpacking chromium-sandbox (90.0.4430.212-1~deb10u1) ...\n",
            "Selecting previously unselected package libplist3:amd64.\n",
            "Preparing to unpack .../15-libplist3_2.1.0-4build2_amd64.deb ...\n",
            "Unpacking libplist3:amd64 (2.1.0-4build2) ...\n",
            "Selecting previously unselected package libusbmuxd6:amd64.\n",
            "Preparing to unpack .../16-libusbmuxd6_2.0.1-2_amd64.deb ...\n",
            "Unpacking libusbmuxd6:amd64 (2.0.1-2) ...\n",
            "Selecting previously unselected package libimobiledevice6:amd64.\n",
            "Preparing to unpack .../17-libimobiledevice6_1.2.1~git20191129.9f79242-1build1_amd64.deb ...\n",
            "Unpacking libimobiledevice6:amd64 (1.2.1~git20191129.9f79242-1build1) ...\n",
            "Selecting previously unselected package libu2f-udev.\n",
            "Preparing to unpack .../18-libu2f-udev_1.1.10-1_all.deb ...\n",
            "Unpacking libu2f-udev (1.1.10-1) ...\n",
            "Selecting previously unselected package libupower-glib3:amd64.\n",
            "Preparing to unpack .../19-libupower-glib3_0.99.11-1build2_amd64.deb ...\n",
            "Unpacking libupower-glib3:amd64 (0.99.11-1build2) ...\n",
            "Selecting previously unselected package notification-daemon.\n",
            "Preparing to unpack .../20-notification-daemon_3.20.0-4_amd64.deb ...\n",
            "Unpacking notification-daemon (3.20.0-4) ...\n",
            "Selecting previously unselected package upower.\n",
            "Preparing to unpack .../21-upower_0.99.11-1build2_amd64.deb ...\n",
            "Unpacking upower (0.99.11-1build2) ...\n",
            "Selecting previously unselected package usbmuxd.\n",
            "Preparing to unpack .../22-usbmuxd_1.1.1~git20191130.9af2b12-1_amd64.deb ...\n",
            "Unpacking usbmuxd (1.1.1~git20191130.9af2b12-1) ...\n",
            "Setting up libplist3:amd64 (2.1.0-4build2) ...\n",
            "Setting up libxtst6:amd64 (2:1.2.3-1) ...\n",
            "Setting up libxxf86dga1:amd64 (2:1.1.5-0ubuntu1) ...\n",
            "Setting up chromium-sandbox (90.0.4430.212-1~deb10u1) ...\n",
            "Setting up libicu63:amd64 (63.1-6+deb10u3) ...\n",
            "Setting up notification-daemon (3.20.0-4) ...\n",
            "Setting up libfontenc1:amd64 (1:1.1.4-0ubuntu1) ...\n",
            "Setting up libjpeg62-turbo:amd64 (1:1.5.2-2+deb10u1) ...\n",
            "Setting up udev (245.4-4ubuntu3.21) ...\n",
            "invoke-rc.d: could not determine current runlevel\n",
            "invoke-rc.d: policy-rc.d denied execution of start.\n",
            "Setting up libevent-2.1-6:amd64 (2.1.8-stable-4) ...\n",
            "Setting up libusbmuxd6:amd64 (2.0.1-2) ...\n",
            "Setting up libupower-glib3:amd64 (0.99.11-1build2) ...\n",
            "Setting up libre2-5:amd64 (20200101+dfsg-1build1) ...\n",
            "Setting up libxkbfile1:amd64 (1:1.1.0-1) ...\n",
            "Setting up libimobiledevice6:amd64 (1.2.1~git20191129.9f79242-1build1) ...\n",
            "Setting up libvpx5:amd64 (1.7.0-3+deb10u1) ...\n",
            "Setting up libu2f-udev (1.1.10-1) ...\n",
            "Failed to send reload request: No such file or directory\n",
            "Setting up upower (0.99.11-1build2) ...\n",
            "Setting up usbmuxd (1.1.1~git20191130.9af2b12-1) ...\n",
            "Warning: The home dir /var/lib/usbmux you specified can't be accessed: No such file or directory\n",
            "Adding system user `usbmux' (UID 105) ...\n",
            "Adding new user `usbmux' (UID 105) with group `plugdev' ...\n",
            "Not creating home directory `/var/lib/usbmux'.\n",
            "Setting up x11-utils (7.7+5) ...\n",
            "Setting up chromium-common (90.0.4430.212-1~deb10u1) ...\n",
            "Setting up chromium (90.0.4430.212-1~deb10u1) ...\n",
            "update-alternatives: using /usr/bin/chromium to provide /usr/bin/x-www-browser (x-www-browser) in auto mode\n",
            "update-alternatives: using /usr/bin/chromium to provide /usr/bin/gnome-www-browser (gnome-www-browser) in auto mode\n",
            "Setting up chromium-driver (90.0.4430.212-1~deb10u1) ...\n",
            "Processing triggers for systemd (245.4-4ubuntu3.21) ...\n",
            "Processing triggers for man-db (2.9.1-1) ...\n",
            "Processing triggers for dbus (1.12.16-2ubuntu2.3) ...\n",
            "Processing triggers for mime-support (3.64ubuntu1) ...\n",
            "Processing triggers for hicolor-icon-theme (0.17-2) ...\n",
            "Processing triggers for libc-bin (2.31-0ubuntu9.9) ...\n",
            "Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n",
            "Collecting selenium\n",
            "  Downloading selenium-4.10.0-py3-none-any.whl (6.7 MB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m6.7/6.7 MB\u001b[0m \u001b[31m82.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hRequirement already satisfied: urllib3[socks]<3,>=1.26 in /usr/local/lib/python3.10/dist-packages (from selenium) (1.26.15)\n",
            "Collecting trio~=0.17 (from selenium)\n",
            "  Downloading trio-0.22.0-py3-none-any.whl (384 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m384.9/384.9 kB\u001b[0m \u001b[31m37.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hCollecting trio-websocket~=0.9 (from selenium)\n",
            "  Downloading trio_websocket-0.10.2-py3-none-any.whl (17 kB)\n",
            "Requirement already satisfied: certifi>=2021.10.8 in /usr/local/lib/python3.10/dist-packages (from selenium) (2022.12.7)\n",
            "Requirement already satisfied: attrs>=19.2.0 in /usr/local/lib/python3.10/dist-packages (from trio~=0.17->selenium) (23.1.0)\n",
            "Requirement already satisfied: sortedcontainers in /usr/local/lib/python3.10/dist-packages (from trio~=0.17->selenium) (2.4.0)\n",
            "Collecting async-generator>=1.9 (from trio~=0.17->selenium)\n",
            "  Downloading async_generator-1.10-py3-none-any.whl (18 kB)\n",
            "Requirement already satisfied: idna in /usr/local/lib/python3.10/dist-packages (from trio~=0.17->selenium) (3.4)\n",
            "Collecting outcome (from trio~=0.17->selenium)\n",
            "  Downloading outcome-1.2.0-py2.py3-none-any.whl (9.7 kB)\n",
            "Requirement already satisfied: sniffio in /usr/local/lib/python3.10/dist-packages (from trio~=0.17->selenium) (1.3.0)\n",
            "Requirement already satisfied: exceptiongroup>=1.0.0rc9 in /usr/local/lib/python3.10/dist-packages (from trio~=0.17->selenium) (1.1.1)\n",
            "Collecting wsproto>=0.14 (from trio-websocket~=0.9->selenium)\n",
            "  Downloading wsproto-1.2.0-py3-none-any.whl (24 kB)\n",
            "Requirement already satisfied: PySocks!=1.5.7,<2.0,>=1.5.6 in /usr/local/lib/python3.10/dist-packages (from urllib3[socks]<3,>=1.26->selenium) (1.7.1)\n",
            "Collecting h11<1,>=0.9.0 (from wsproto>=0.14->trio-websocket~=0.9->selenium)\n",
            "  Downloading h11-0.14.0-py3-none-any.whl (58 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m58.3/58.3 kB\u001b[0m \u001b[31m6.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hInstalling collected packages: outcome, h11, async-generator, wsproto, trio, trio-websocket, selenium\n",
            "Successfully installed async-generator-1.10 h11-0.14.0 outcome-1.2.0 selenium-4.10.0 trio-0.22.0 trio-websocket-0.10.2 wsproto-1.2.0\n",
            "Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n",
            "Requirement already satisfied: gspread in /usr/local/lib/python3.10/dist-packages (3.4.2)\n",
            "Collecting gspread\n",
            "  Downloading gspread-5.9.0-py3-none-any.whl (40 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m41.0/41.0 kB\u001b[0m \u001b[31m4.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hCollecting gspread_formatting\n",
            "  Downloading gspread_formatting-1.1.2-py2.py3-none-any.whl (22 kB)\n",
            "Requirement already satisfied: google-auth>=1.12.0 in /usr/local/lib/python3.10/dist-packages (from gspread) (2.17.3)\n",
            "Requirement already satisfied: google-auth-oauthlib>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from gspread) (1.0.0)\n",
            "Requirement already satisfied: cachetools<6.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth>=1.12.0->gspread) (5.3.0)\n",
            "Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth>=1.12.0->gspread) (0.3.0)\n",
            "Requirement already satisfied: six>=1.9.0 in /usr/local/lib/python3.10/dist-packages (from google-auth>=1.12.0->gspread) (1.16.0)\n",
            "Requirement already satisfied: rsa<5,>=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth>=1.12.0->gspread) (4.9)\n",
            "Requirement already satisfied: requests-oauthlib>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib>=0.4.1->gspread) (1.3.1)\n",
            "Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules>=0.2.1->google-auth>=1.12.0->gspread) (0.5.0)\n",
            "Requirement already satisfied: oauthlib>=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib>=0.4.1->gspread) (3.2.2)\n",
            "Requirement already satisfied: requests>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib>=0.4.1->gspread) (2.27.1)\n",
            "Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.0.0->requests-oauthlib>=0.7.0->google-auth-oauthlib>=0.4.1->gspread) (1.26.15)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.0.0->requests-oauthlib>=0.7.0->google-auth-oauthlib>=0.4.1->gspread) (2022.12.7)\n",
            "Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests>=2.0.0->requests-oauthlib>=0.7.0->google-auth-oauthlib>=0.4.1->gspread) (2.0.12)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.0.0->requests-oauthlib>=0.7.0->google-auth-oauthlib>=0.4.1->gspread) (3.4)\n",
            "Installing collected packages: gspread, gspread_formatting\n",
            "  Attempting uninstall: gspread\n",
            "    Found existing installation: gspread 3.4.2\n",
            "    Uninstalling gspread-3.4.2:\n",
            "      Successfully uninstalled gspread-3.4.2\n",
            "Successfully installed gspread-5.9.0 gspread_formatting-1.1.2\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": []
          },
          "metadata": {},
          "execution_count": 1
        }
      ],
      "source": [
        "########起動前に必ずこちらを動かす事######################\n",
        "%%shell\n",
        "# Ubuntu no longer distributes chromium-browser outside of snap\n",
        "#\n",
        "# Proposed solution: https://askubuntu.com/questions/1204571/how-to-install-chromium-without-snap\n",
        "\n",
        "# Add debian buster\n",
        "cat > /etc/apt/sources.list.d/debian.list <<'EOF'\n",
        "deb [arch=amd64 signed-by=/usr/share/keyrings/debian-buster.gpg] http://deb.debian.org/debian buster main\n",
        "deb [arch=amd64 signed-by=/usr/share/keyrings/debian-buster-updates.gpg] http://deb.debian.org/debian buster-updates main\n",
        "deb [arch=amd64 signed-by=/usr/share/keyrings/debian-security-buster.gpg] http://deb.debian.org/debian-security buster/updates main\n",
        "EOF\n",
        "\n",
        "# Add keys\n",
        "apt-key adv --keyserver keyserver.ubuntu.com --recv-keys DCC9EFBF77E11517\n",
        "apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 648ACFD622F3D138\n",
        "apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 112695A0E562B32A\n",
        "\n",
        "apt-key export 77E11517 | gpg --dearmour -o /usr/share/keyrings/debian-buster.gpg\n",
        "apt-key export 22F3D138 | gpg --dearmour -o /usr/share/keyrings/debian-buster-updates.gpg\n",
        "apt-key export E562B32A | gpg --dearmour -o /usr/share/keyrings/debian-security-buster.gpg\n",
        "\n",
        "# Prefer debian repo for chromium* packages only\n",
        "# Note the double-blank lines between entries\n",
        "cat > /etc/apt/preferences.d/chromium.pref << 'EOF'\n",
        "Package: *\n",
        "Pin: release a=eoan\n",
        "Pin-Priority: 500\n",
        "\n",
        "\n",
        "Package: *\n",
        "Pin: origin \"deb.debian.org\"\n",
        "Pin-Priority: 300\n",
        "\n",
        "\n",
        "Package: chromium*\n",
        "Pin: origin \"deb.debian.org\"\n",
        "Pin-Priority: 700\n",
        "EOF\n",
        "\n",
        "# Install chromium and chromium-driver\n",
        "apt-get update\n",
        "apt-get install chromium chromium-driver\n",
        "\n",
        "# Install selenium\n",
        "pip install selenium\n",
        "pip install --upgrade gspread gspread_formatting"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 378
        },
        "id": "wvRraAANGRzk",
        "outputId": "fb9c8ac1-14d0-4162-f10a-2c106b40a647"
      },
      "outputs": [
        {
          "output_type": "error",
          "ename": "ModuleNotFoundError",
          "evalue": "ignored",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mModuleNotFoundError\u001b[0m                       Traceback (most recent call last)",
            "\u001b[0;32m<ipython-input-1-7e5aad4f38d6>\u001b[0m in \u001b[0;36m<cell line: 11>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      9\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     10\u001b[0m \u001b[0;31m# import library\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 11\u001b[0;31m \u001b[0;32mfrom\u001b[0m \u001b[0mselenium\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mwebdriver\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     12\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mselenium\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwebdriver\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcommon\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mby\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mBy\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     13\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mselenium\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwebdriver\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcommon\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkeys\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mKeys\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mModuleNotFoundError\u001b[0m: No module named 'selenium'",
            "",
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0;32m\nNOTE: If your import is failing due to a missing package, you can\nmanually install dependencies using either !pip or !apt.\n\nTo view examples of installing some common dependencies, click the\n\"Open Examples\" button below.\n\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n"
          ],
          "errorDetails": {
            "actions": [
              {
                "action": "open_url",
                "actionText": "Open Examples",
                "url": "/notebooks/snippets/importing_libraries.ipynb"
              }
            ]
          }
        }
      ],
      "source": [
        "#ID/パスワードの順序は同一であること\n",
        "login = [\"\",\"\"] #1アカウント毎にカンマ区切り\n",
        "password = [\"\",\"\"]\n",
        "#チーム内優先順位[1枠目,2枠目,3枠目,4枠目] 1が最優先、4が最低　アカウント数分[]を作ること。※[]の最後以外は「,」で区切ること\n",
        "TeamPriority = [\n",
        "    [4,2,3,1],\n",
        "    [1,2,3,4]\n",
        "]\n",
        "\n",
        "# import library\n",
        "from selenium import webdriver\n",
        "from selenium.webdriver.common.by import By\n",
        "from selenium.webdriver.common.keys import Keys\n",
        "from bs4 import BeautifulSoup\n",
        "import time\n",
        "import datetime\n",
        "from google.colab import auth\n",
        "from google.auth import default\n",
        "import gspread\n",
        "from oauth2client.client import GoogleCredentials\n",
        "\n",
        "# ブラウザをheadlessモード実行\n",
        "options = webdriver.ChromeOptions()\n",
        "#ヘッドレスモード（バックグラウンドで起動）で実行。コラボの場合、必須。\n",
        "options.add_argument('--headless')\n",
        "#サンドボックスモードの解除。これも必須。\n",
        "options.add_argument('--no-sandbox')\n",
        "#これも設定した方がよい。\n",
        "options.add_argument('--disable-dev-shm-usage')\n",
        "\n",
        "#インスタンス化\n",
        "options.headless = True\n",
        "from selenium.webdriver.chrome.service import Service as ChromeService\n",
        "driver = webdriver.Chrome(service=ChromeService(\"/usr/bin/chromedriver\"),options=options)\n",
        "\n",
        "#指定したドライバーが見つかるまで待機\n",
        "driver.implicitly_wait(3)\n",
        "\n",
        "#urlの指定\n",
        "url=\"https://bcg.metastrikers.xyz/\"\n",
        "driver.get(url)\n",
        "time.sleep(5)\n",
        "\n",
        "answers = {}\n",
        "def find_string_and_check_sequence():\n",
        "    # Google Colabの認証\n",
        "    auth.authenticate_user()\n",
        "    creds, _ = default()\n",
        "    gc = gspread.authorize(creds)\n",
        "    # スプレッドシートを開く\n",
        "    workbook = gc.open_by_url(\"https://docs.google.com/spreadsheets/d/1FFuuU--zoEhi6W6quAiSIpI-tOOgxauK8PCaSosXhH8\")\n",
        "    sheet = workbook.get_worksheet(0)\n",
        "    data = sheet.get_all_values()\n",
        "    for row in data:\n",
        "        if len(row[1]) < 10:\n",
        "            continue\n",
        "        answers[row[5]+row[1][:10]] = [row[2]]\n",
        "find_string_and_check_sequence()\n",
        "\n",
        "def Scroll(Xpath):\n",
        "    time.sleep(0.5)\n",
        "    element = driver.find_element(By.XPATH,Xpath)\n",
        "    driver.execute_script(\"arguments[0].scrollIntoView(true);\", element)\n",
        "def Click(Xpath):\n",
        "    Scroll(Xpath)\n",
        "    time.sleep(0.5)\n",
        "    driver.find_element(By.XPATH, Xpath).click()\n",
        "    time.sleep(0.5)\n",
        "\n",
        "for acountcount in range(len(login)):\n",
        "  try:\n",
        "        #Start押下\n",
        "        Click('//*[@id=\"root\"]/div/div/div[1]/div/div/div/div/p')\n",
        "        driver.find_element(By.XPATH,'//*[@id=\"root\"]/div/div/div[1]/div/div[1]/div/div/div/div[2]/div/input').send_keys(login[acountcount])\n",
        "        driver.find_element(By.XPATH,'//*[@id=\"root\"]/div/div/div[1]/div/div[1]/div/div/div/div[3]/div/input').send_keys(password[acountcount])\n",
        "        print(login[acountcount],password[acountcount])\n",
        "        #ログインクリック\n",
        "        Click('//*[@id=\"root\"]/div/div/div[1]/div/div[1]/div/div/div/div[4]')\n",
        "        time.sleep(10)\n",
        "        #設定→日本語\n",
        "        Click('//*[@id=\"root\"]/div/div/div[1]/div/div[2]/img[5]')\n",
        "\n",
        "\n",
        "        try:\n",
        "            Click('//*[@id=\"root\"]/div/div/div[1]/div/div[1]/div[2]/div/div[1]/div/div')\n",
        "            Click('//*[@id=\"menu-\"]/div[3]/ul/li[2]')\n",
        "            time.sleep(0.5)\n",
        "            for i in range(2):\n",
        "                #チームクリック\n",
        "                print('チームクリック')\n",
        "                Click('//*[@id=\"root\"]/div/div/div[1]/div/div[2]/img[3]')\n",
        "\n",
        "                #ストライカー選択\n",
        "                for i in range(1,5):\n",
        "                    targetstriker = TeamPriority[acountcount].index(i) + 1\n",
        "                    print('ストライカーテンションチェック')\n",
        "                    imgElement = driver.find_element(By.XPATH,'//*[@id=\"root\"]/div/div/div[1]/div/div[1]/div[2]/div/div[2]/div[2]/div[2]/div[1]/div[3]/div['+str(targetstriker)+']/div/div[1]/img')\n",
        "                    imgsrc = imgElement.get_attribute('src')\n",
        "                    bsrc = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH0AAAB9CAMAAAC4XpwXAAAAYFBMVEVHcEwIAQMIAQMIAQMIAQMIAQMIAQMIAQMIAQMIAQMHAQL/Skj/UVAAAAD/Pzz/RUL/Ojf/EQ7/Ghf/JCD/LCn/NDArCQnbNjRIEBAbBQaQIB+4NTRtFxfaFxTqRUSyFRSoTbKBAAAACnRSTlMAzlHhp2YY8DCC0QzlrQAACDNJREFUaN7tWweXgygQvhRTNKZHFFD//7882gCD2KK7+969G6PZjcN80ygi/PPP/zSPDofTNknOmpJkezocfgn4lJz3m90x9em42+zPyemHVTgl+w3GRTps9snpx6DPA8hAu835BxQ4JPtxaOOCfXJY2exdOod2KzrgFDe7qqqiKMQ17oDTD2FXRckpY4w0kghhjPKyqH4A/xD4vCq5QL10qSGMl1Xg/4Xx324wNI0iOw0oVmCzXc3pAvoyTkIBH/979/uGVyVrLtOoYb4DvjT/cHaGV5xd5hDjDv/4TfRPeyieC7svc4mVS7zvef0L7AB/rve3O2s4bS7fUUOt+3ez4JPjQsND84/JN+C8uSyhhs+Ht+AVvSwl6/2p8Ba8YKb+UjbXBa4MK2bBbwG8JFA8TwtOZmATrspo5QkE/7idke2l0b3KFaV8qgNEU6OLVMZ35eTMP20w+IXnQKKhbyZUszK1BfgFw29Gmp3D3gfPZMncwafFSEdDaJF7JIRkCH4/3OievZirglmZIxItvvpd30WUWZdb9Mww2tifp2RcocEzcfA8IN3bmbvuED1bGrJyc0/AF+OZB0GX6eLKhTJ1AgTYMtwhumeDSF6Tef2h30PTDm6XX6Rrk65NliUTtTKP6Eicf0SzA6Ef8zsX/Ip0wZhPZWwcS9Q/Ij6ZdY748GHfH7TfRaZqqaaUPDv5JGKaQehjuSFzM4PSJjgm8zaHoXyvmNPXfsK6JPPZSQ/qhaiXgOkMyGzoo3l/0o1cTrOAlItxO6LRwTqELlMSMD0F5UkHEm8PzUwW2A2ScAC4pxz3Xd64rLEqaCng+0jinUzKsWyIRP8Btcn5JWvgR058f2XhP8wk3qnX9EFwIahR4/WSYKVKPd7HqB3qNd6YXg2brmXIJ7jwR/FY14xgS64qbvwZqvrPEo+m/WE32fRBuk0zfofrfGKifpMClhxjDCbySaxbZ/3a3zKQHb3hGIY9wCJ5Z3JO1HUhvkPZjVDOOSW32O3spn/MzMfxRgjSHuXdGZq5qDOJbmTEALux7rWOCLjFA4xpdsgtIuwGDZ6fd7p/qYgzxTtJ6Q2Vbr5Nmb3C6Q3EStK9L6XpvNt0HR/1lj+yy3ng7uCr4WhUd+sKhLzzXG8ynsYidaOo/2K3WzyiihgaCPTIC7N+7xzfNR33rOVtiHBXWzSxvDOu3wfDirIZNyePq2iI4DFIyqLmlHiQYcIuYnr1uMzfLBi1sA6Hhx6MwCLoogzHgTdhZ+qmO/QXzTv2YAZ3Cf0kAn/tHJ3Amx6GgECrZkRiRSwDcLtLxPMYWJUygT+jpCsaa4gmXSYYr5aNZQCL7XFtgqwjIA9O9dUUftpB0gGiL09c0IA1pderfxfLDWonx+rB1xWlneldubMaETLeM/0auuAaGC9MvwWM+ov7vaxJeeo8hHx7ZRXyZXi7T9WKYVT7p0k7k/Rbk/LXPoJnGTGau44RsbwD8jTgdhr6vWG8LErO7tdxuhveZoDDR09MO9vPfr8LDaZAg7Z3VabXP5VX4c8W/d5zyMvdXsYPVab/NqrwFr1XW6tDL8sd8UKBHtYIekHuvWQtmkDOT71kJjICdA3Q/SDZI58pvF30vNf2SRbPYo7YXpH7b1E06xDHh6xJn370JIZOqzWJ+nbdmV/foa0Tv7uDyqnJlUgMMzzJ90+spW2RfjRfk6gv+tP66LqPk/o5Whc9DWT7fRz0777jhX5rordINurfYWzz8YmtiC5yCsnGQ2ozriM+B6lWtL3CotG4zlZ4n+VdrIheIMnBmBYe47B7VkTHQQ3G8/AsIxVTH3mumfRUCQXhwbMMpN3b3FefFZNepPzHyX4Hz3EwU1jDfXmsmHYqnwH+UwfPsC7wb0Efc64X+BLEysun8/wOcxfKaLjQ9Vq6tyf23Z02MvM2tVVSUL2W64VYkPmRYsN5Gztn9Xb0Wcv1afn2KTJnZV3v00pZn7ZIatGdr9NzlZjxRVZp7kQLjk2KzJHDPC120jpNzfvlyYzN09o56lawwvGu1zC+kKlsRbbROWo7P+95fh3j6dvZ/nrH5+dhgCOM96xfbnyqTLcC2553E/a9zMuQ5k4XJ7wQ40T2vpSCd1Kt0VNxv8qldV1JAtvb3ndSYHxRg6KSFvpeCbPG1/3v4+BdZMVfL89Xy3zfvnziQy/B4T1sUGQBOEeS2qH3sDDISMvaL/P8PvQlAq+H30G79++4VLEk6B2/9699gAUnVJhsj2/hJbiT8hxde+DWXbSyoD2/gteWP1/mCkEfWnJj15zUL6O4+nwBLyQ8PcvrYspqJ7vepn4+XelnPTf1ZHmtuhJTT1pvY19KQvEnFOdz6n3Ka3CbtnziWiNvnVVtjVdEpw/zKvpEVE9dZ+WvMas7Mia27XUP+JTVlW59XSDlSackXxEY7sCPk5Z2wtrCvGixnEc9il/RUOW2+HZpoxfAhzieD4mfDgwlBLZk8/1Vfb+sUyavAn5oDQT+o+VRBdKCtw+D/YCj5suWtJatESRIXJTkuuUl0iAtSt7WD833fFjw9qv1tF7mi/6+drhKCUV13cq3/JJoW9cPrZ0DV4Z/uZYYr6Nutd0OIUZP9CUjVCxYxe6tIdf486gtl63gx+vn5+G3S9fPY+/n1Qz7W3/vwO7rrRN434SozROga7RvYtm2FbRnRDhgRIFa7hnJV9ozEt8vAxUsAJatwMr7ZTruV4253CvUCiUMta3eK4Sn9H9ur5IGkvukKrVPqvsqYS3soT1i+S/sEfvr/XF/vTfwz/dF/vmeUH8/7Nbuh93+3n7Y/xD9C9nkfB2+j+EsAAAAAElFTkSuQmCC\"\n",
        "                    if imgsrc != bsrc :\n",
        "                        #ストライカー選択\n",
        "                        print('ストライカークリック')\n",
        "                        Click('//*[@id=\"root\"]/div/div/div[1]/div/div[1]/div[2]/div/div[2]/div[2]/div[2]/div[1]/div[3]/div['+str(targetstriker)+']')\n",
        "                        break\n",
        "                strikertype = driver.find_element(By.XPATH,'//*[@id=\"root\"]/div/div/div[1]/div/div/div[3]/div/div/div/div[3]/div[3]/div[2]/div[2]/div/div[1]/div[1]').text\n",
        "\n",
        "                #メニュークリック\n",
        "                print('メニュークリック')\n",
        "                Click('//*[@id=\"root\"]/div/div/div[1]/div/div/div[3]/div/div/div/div[3]/div[1]')\n",
        "                time.sleep(0.5)\n",
        "\n",
        "                #ミーティング\n",
        "                print('ミーティングクリック')\n",
        "                Click('//*[@id=\"root\"]/div/div/div[1]/div/div/div[3]/div/div/div/div[3]/div[2]/div/div/div/div[1]/div')\n",
        "                time.sleep(0.5)\n",
        "                #START\n",
        "                print('STARTクリック')\n",
        "                Click('//*[@id=\"root\"]/div/div/div[1]/div/div/div[3]/div/div/div/div[3]/div[2]/div/div/div/div[2]/div/div/div/div[2]/div/div[2]')\n",
        "                time.sleep(1)\n",
        "\n",
        "                target_string = driver.find_element(By.XPATH,'//*[@id=\"root\"]/div/div/div[1]/div/div/div[3]/div/div/div/div[3]/div[2]/div/div/div/div[2]/div/div/div/div/div[1]/p').text\n",
        "                target_sequence = [driver.find_element(By.XPATH,'//*[@id=\"root\"]/div/div/div[1]/div/div/div[3]/div/div/div/div[3]/div[2]/div/div/div/div[2]/div/div/div/div/div[2]/div[1]').text,\n",
        "                                driver.find_element(By.XPATH,'//*[@id=\"root\"]/div/div/div[1]/div/div/div[3]/div/div/div/div[3]/div[2]/div/div/div/div[2]/div/div/div/div/div[2]/div[2]').text,\n",
        "                                driver.find_element(By.XPATH,'//*[@id=\"root\"]/div/div/div[1]/div/div/div[3]/div/div/div/div[3]/div[2]/div/div/div/div[2]/div/div/div/div/div[2]/div[3]').text,\n",
        "                                driver.find_element(By.XPATH,'//*[@id=\"root\"]/div/div/div[1]/div/div/div[3]/div/div/div/div[3]/div[2]/div/div/div/div[2]/div/div/div/div/div[2]/div[4]').text]\n",
        "                print(target_string,target_sequence)\n",
        "                print(\"search:\",strikertype+target_string[:10])\n",
        "                result = answers[strikertype+target_string[:10]]\n",
        "                if result ==\"\" :\n",
        "                    print(\"回答無しの為終了。管理者に問い合わせてください。:\",target_string)\n",
        "                    break\n",
        "                else : target_index = target_sequence.index(result) + 1\n",
        "                print(target_index)\n",
        "\n",
        "                Click('//*[@id=\"root\"]/div/div/div[1]/div/div/div[3]/div/div/div/div[3]/div[2]/div/div/div/div[2]/div/div/div/div/div[2]/div['+str(target_index)+']')\n",
        "                print('回答確定')\n",
        "                Click('//*[@id=\"root\"]/div/div/div[1]/div/div/div[3]/div/div/div/div[3]/div[2]/div/div/div/div[2]/div/div/div/div/div[2]/div[5]/div')\n",
        "                time.sleep(2)\n",
        "                driver.refresh()\n",
        "                #念の為10秒\n",
        "                time.sleep(10)\n",
        "        except Exception as e:\n",
        "            print(\"エラー:多分ミーティング回数超過\")\n",
        "            driver.refresh()\n",
        "            time.sleep(5)\n",
        "        time.sleep(5)\n",
        "        #設定クリック\n",
        "        print('設定クリック')\n",
        "        Click('//*[@id=\"root\"]/div/div/div[1]/div/div[2]/img[5]')\n",
        "        time.sleep(1)\n",
        "        element = driver.find_element(By.XPATH,'//*[@id=\"root\"]/div/div/div[1]/div/div[1]/div[2]/div/div[5]')\n",
        "        driver.execute_script(\"arguments[0].scrollIntoView(true);\", element)\n",
        "        #ログアウト\n",
        "        print('ログアウト')\n",
        "        Click('//*[@id=\"root\"]/div/div/div[1]/div/div[1]/div[2]/div/div[5]')\n",
        "        time.sleep(1)\n",
        "        print('確定')\n",
        "        Click('//*[@id=\"root\"]/div/div/div[1]/div/div/div[2]/div/div[6]/div/div/div/div[1]')\n",
        "        time.sleep(4)\n",
        "  except:\n",
        "    print(\"ログイン失敗:\",login[acountcount],\"/\",password[acountcount])\n",
        "    driver.refresh()\n",
        "    time.sleep(5)\n",
        "\n"
      ]
    }
  ],
  "metadata": {
    "colab": {
      "provenance": [],
      "include_colab_link": true
    },
    "gpuClass": "standard",
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}